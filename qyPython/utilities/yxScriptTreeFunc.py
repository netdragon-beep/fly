import json, uuid
from utilities.dataParser import *


class YxScriptTreeFunc:
    def __init__(self, ws, room_id=None):
        self.ws = ws
        self.sim_data = SimData()
        self.red_side = SideListItem('red')
        self.blue_side = SideListItem('blue')
        self.sim_data.side_list.append(self.red_side)
        self.sim_data.side_list.append(self.blue_side)
        self.sim_start = False
        self.s_ws = None
        self.room_id = room_id
        self.wait_next = True
        self.sim_data.set_frame(1)
        self.send_list = []
        self.user_side = 'red'
        self.sim_data.set_user_side(self.user_side)

    def reset(self):
        self.sim_data = SimData()
        self.sim_data.set_user_side(self.user_side)
        self.red_side = SideListItem('red')
        self.blue_side = SideListItem('blue')
        self.sim_data.side_list.append(self.red_side)
        self.sim_data.side_list.append(self.blue_side)
        self.sim_data.set_frame(1)

    # 获取态势数据，返回dict
    def get_sim_data(self) -> dict:
        return self.sim_data.to_dict()

    def send_msg(self, data) -> bool:
        if self.ws is None:
            print("未获取到ws，请重试")
            return False
        if self.room_id is not None:
            data['roomId'] = self.room_id
        json_data = json.dumps(data, ensure_ascii=False, separators=(',', ':'))
        if config.is_print_debug:
            print(f'发送消息：{json_data}')
        return self.ws.send(json_data)

    def send_msg_ws(self, data) -> bool:
        if 'autoRelay' not in data:
            data['autoRelay'] = True
        json_data = json.dumps(data, ensure_ascii=False, separators=(',', ':'))
        if config.is_print_debug:
            print(f'发送消息：{json_data}')
        return self.s_ws.send(json_data)

    def send_str_ws(self, json_str):
        return self.s_ws.send(json_str)

    def set_battlefield_boundaries(self, min_lon: float, max_lon: float,
                                   min_lat: float, max_lat: float):
        """
        通过调用“设置边界值”函数同步真实战场边界，避免0.01默认值导致越界误判。
        """
        if self.s_ws is None:
            print("未连接推演服务器，无法设置战场边界")
            return False

        try:
            lon1 = float(min_lon)
            lon2 = float(max_lon)
            lat1 = float(min_lat)
            lat2 = float(max_lat)
        except (TypeError, ValueError):
            print("战场边界数据无效，跳过设置")
            return False

        data = {
            "fun": "yxCallFun",
            "data": {
                "funId": "00963746FBF4AE5E6CDD169C458AEBDD",
                "returnType": "none",
                "argNames": [
                    "@fun:lon1",
                    "@fun:lon2",
                    "@fun:@addr:max_lon",
                    "@fun:@addr:min_lon",
                    "@fun:lat1",
                    "@fun:lat2",
                    "@fun:@addr:max_lat",
                    "@fun:@addr:min_lat"
                ],
                "argValues": [
                    lon1,
                    lon2,
                    "@variable:max_lon&globle",
                    "@variable:min_lon&globle",
                    lat1,
                    lat2,
                    "@variable:max_lat&globle",
                    "@variable:min_lat&globle"
                ]
            },
            "autoRelay": False
        }
        return self.send_msg_ws(data)


    @staticmethod
    def go_to_speed(self_platform: str, speed: float):
        """
        达到指定速度
        self_platform : 自身平台名称
        speed : 速度（单位：米/秒）
        """
        if config.send_to_ws:
            json_strs = [
                "{\"fun\":\"yxCallFun\",\"data\":{\"funIndex\":0,\"nodeId\":\"659B9421CD10DBEB628F105A4B4B4BA2\",\"class\":\"@function\",\"name\":\"达到指定速度\",\"returnType\":\"none\",\"returnValue\":null,\"args\":[\"WsfPlatform\",\"double\"],\"argValues\":[",
                "\"", self_platform, "\",",
                str(speed),
                "],\"argNames\":[\"@fun:执行平台\",\"@fun:速度\"],\"next\":[{\"funIndex\":6,\"nodeId\":\"2A6B69382E948DCD15A0ED1E252B8FE5\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"GoToSpeed\",\"index\":188,\"args\":[\"double\"],\"argValues\":[\"@fun:速度\"],\"next\":[{\"returnValue\":{\"name\":\"@funIndex:0\"},\"nodeId\":\"DD31C9EAADA873B7764F05650A3820DE\",\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"659B9421CD10DBEB628F105A4B4B4BA2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"659B9421CD10DBEB628F105A4B4B4BA2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"659B9421CD10DBEB628F105A4B4B4BA2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"659B9421CD10DBEB628F105A4B4B4BA2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"@variable\":{}},\"returnType\":\"none\",\"autoRelay\":false,\"funId\":\"659B9421CD10DBEB628F105A4B4B4BA2\"}"
            ]
            json_data = "".join(json_strs)
        else:
            json_data = {
                "fun": "infoGlobalFun",
                "funcName": "达到指定速度",
                "taskId": config.task_id,
                "argValues": [self_platform, speed],
                "isTask": False
            }
        return {
                "func_name": "go_to_speed",
                "args": [self_platform, speed],
                "json_data": json_data
            }

    @staticmethod
    def go_to_speed_la(self_platform: str, speed: float, linear_accel: float):
        """
        以指定线性加速度加速到指定速度
        self_platform : 自身平台名称
        speed : 速度（单位：米/秒）
        linear_accel : 线性加速度（单位：米/秒^2）
        """
        if config.send_to_ws:
            json_strs = [
                "{\"fun\":\"yxCallFun\",\"data\":{\"funIndex\":0,\"nodeId\":\"CC38AB721FEF4A7D16AFAA27E1B09CD8\",\"class\":\"@function\",\"name\":\"以指定线性加速度达到速度\",\"returnType\":\"none\",\"returnValue\":null,\"args\":[\"WsfPlatform\",\"double\",\"double\"],\"argValues\":[",
                "\"", self_platform, "\",",
                str(speed), ",",
                str(linear_accel),
                "],\"argNames\":[\"@fun:执行平台\",\"@fun:速度\",\"@fun:线性加速度\"],\"next\":[{\"funIndex\":6,\"nodeId\":\"BC53A438C0E6E3705011D43C5EB41B97\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"GoToSpeed\",\"index\":189,\"args\":[\"double\",\"double\"],\"argValues\":[\"@fun:速度\",\"@fun:线性加速度\"],\"next\":[{\"returnValue\":{\"name\":\"@funIndex:0\"},\"nodeId\":\"7F1BB24116922BE17CE92F4EC1326FCC\",\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"CC38AB721FEF4A7D16AFAA27E1B09CD8\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"CC38AB721FEF4A7D16AFAA27E1B09CD8\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"CC38AB721FEF4A7D16AFAA27E1B09CD8\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"CC38AB721FEF4A7D16AFAA27E1B09CD8\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"@variable\":{}},\"returnType\":\"none\",\"autoRelay\":false,\"funId\":\"CC38AB721FEF4A7D16AFAA27E1B09CD8\"}"
            ]
            json_data = "".join(json_strs)
        else:
            json_data = {
                "fun": "infoGlobalFun",
                "funcName": "以指定线性加速度达到速度",
                "taskId": config.task_id,
                "argValues": [self_platform, speed, linear_accel],
                "isTask": False
            }
        return {
            "func_name": "go_to_speed_LA",
            "args": [self_platform, speed, linear_accel],
            "json_data": json_data
        }

    @staticmethod
    def fire_track(self_platform: str, target_name: str, print_debug=0):
        """
        朝目标开火
        self_platform : 自身平台名称
        target_name : 目标平台名称
        """
        if config.send_to_ws:
            json_strs = [
                "{\"fun\":\"yxCallFun\",\"data\":{\"funIndex\":0,\"nodeId\":\"706F612A8384B89167AC019B326F77D9\",\"class\":\"@function\",\"name\":\"朝目标开火\",\"returnType\":\"none\",\"args\":[\"WsfPlatform\",\"string\",\"int\"],\"argValues\":[",
                "\"", self_platform, "\",",
                "\"", target_name, "\",",
                str(print_debug),
                "],\"argNames\":[\"@fun:执行平台\",\"@fun:trackName\",\"@fun:是否打印调试信息\"],\"next\":[{\"funIndex\":42,\"nodeId\":\"F76E45D8A4D4F49C20BEE0B40D600A63\",\"class\":\"@sequence\",\"sequence\":[{\"funIndex\":30,\"nodeId\":\"34C84450A1FCAF1B07C54C3FA38FD665\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"WeaponEntry\",\"index\":336,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":34,\"nodeId\":\"DA50956874D153FADF5834382DFCF98D\",\"class\":\"WsfWeapon\",\"id\":\"@funIndex:30\",\"name\":\"ToString\",\"index\":2,\"next\":[{\"funIndex\":54,\"nodeId\":\"AEF8505C59F87BF35E99E342A5D7C69A\",\"class\":\"@branch\",\"argValues\":[{\"funIndex\":55,\"nodeId\":\"DF7475A75BED6789DF8AB0D8473BA5C3\",\"class\":\"yxBehaviorTools\",\"name\":\"==\",\"index\":35,\"args\":[\"int\",\"int\"],\"argValues\":[\"@fun:是否打印调试信息\",1],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":33,\"nodeId\":\"D88887C706CBAAA5BC685A3CD576B15D\",\"class\":\"__BUILTIN__\",\"name\":\"writeln\",\"index\":3,\"args\":[\"string\"],\"argValues\":[{\"funIndex\":35,\"nodeId\":\"1BE0467BD2C297A85CAE3C46142DC78A\",\"class\":\"yxBehaviorTools\",\"name\":\"append\",\"index\":49,\"args\":[\"string\",\"string\"],\"argValues\":[\"调用：\",{\"funIndex\":36,\"nodeId\":\"4A2FB82433867FE9CF3036B8962F7B0E\",\"class\":\"yxBehaviorTools\",\"name\":\"append\",\"index\":49,\"args\":[\"string\",\"string\"],\"argValues\":[\"@funIndex:34\",{\"funIndex\":37,\"nodeId\":\"94BDC1BF00B91930E9F759D6A84ED82B\",\"class\":\"yxBehaviorTools\",\"name\":\"append\",\"index\":49,\"args\":[\"string\",\"string\"],\"argValues\":[\"对目标\",{\"funIndex\":38,\"nodeId\":\"974085690B682F5A06CFA2CD2552ACC2\",\"class\":\"yxBehaviorTools\",\"name\":\"append\",\"index\":49,\"args\":[\"string\",\"string\"],\"argValues\":[\"@fun:trackName\",\"开火\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":32,\"nodeId\":\"163699960FF4AD32B9A1D7D4A2AADFB7\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"MasterRawTrackList\",\"index\":105,\"next\":[{\"funIndex\":39,\"nodeId\":\"2305098AED98206DC032025DC87D7CF8\",\"class\":\"WsfTrackList\",\"id\":\"@funIndex:32\",\"name\":\"Size\",\"index\":4,\"next\":[{\"funIndex\":40,\"nodeId\":\"802DF4C0C1FF56602155718FED8DCB52\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":41,\"args\":[\"int\",\"int\"],\"argValues\":[\"@funIndex:39\",0],\"next\":[{\"funIndex\":41,\"nodeId\":\"49DE01628683B7731EF24B39B7DF9064\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:40\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":43,\"nodeId\":\"B4A8DB2CCD4ED0531C98FBA6B61696AA\",\"class\":\"@for\",\"argValues\":[0,{\"funIndex\":44,\"nodeId\":\"9DB545A9CC8D94761601223502C3F323\",\"class\":\"yxBehaviorTools\",\"name\":\"-\",\"index\":9,\"args\":[\"int\",\"int\"],\"argValues\":[\"@funIndex:39\",1],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"break\":\"@variable:breakLoop&{\\\"fatherGroupId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"fatherSourceId\\\":\\\"user\\\",\\\"sourceId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"userId\\\":97}@funIndex_0\",\"args\":[\"int\",\"int\"],\"subNext\":{\"funIndex\":45,\"nodeId\":\"28851D7C0963A101BF1B4E4FD36D9E39\",\"class\":\"WsfTrackList\",\"id\":\"@funIndex:32\",\"name\":\"Get\",\"index\":8,\"args\":[\"int\"],\"argValues\":[\"@funIndex:43\"],\"next\":[{\"funIndex\":46,\"nodeId\":\"A8C3004AE95FE870F563D90DB0B332F8\",\"class\":\"WsfTrack\",\"id\":\"@funIndex:45\",\"name\":\"TargetName\",\"index\":115,\"next\":[{\"funIndex\":47,\"nodeId\":\"B834CFE6EFE60B05C39F4B6CFBA032F0\",\"class\":\"yxBehaviorTools\",\"name\":\"==\",\"index\":37,\"args\":[\"string\",\"string\"],\"argValues\":[\"@funIndex:46\",\"@fun:trackName\"],\"next\":[{\"funIndex\":48,\"nodeId\":\"44B647D409C2831E1EB0DE49083A1772\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:47\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":31,\"nodeId\":\"1A40D557427257FA165591C939D9E399\",\"class\":\"WsfWeapon\",\"id\":\"@funIndex:30\",\"name\":\"Fire\",\"index\":114,\"args\":[\"WsfTrack\"],\"argValues\":[\"@funIndex:45\"],\"next\":[{\"funIndex\":50,\"nodeId\":\"1A966B5404C9F1004FE1A5F6AF852A7D\",\"class\":\"@set\",\"argValues\":[\"@variable:breakLoop&{\\\"fatherGroupId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"fatherSourceId\\\":\\\"user\\\",\\\"sourceId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"userId\\\":97}@funIndex_0\",true],\"args\":[\"bool\",\"bool\"],\"next\":[{\"funIndex\":56,\"nodeId\":\"4F2F87A6267E70BCDE7CE7592CEC6DF1\",\"class\":\"@branch\",\"argValues\":[{\"funIndex\":55,\"nodeId\":\"DF7475A75BED6789DF8AB0D8473BA5C3\",\"class\":\"yxBehaviorTools\",\"name\":\"==\",\"index\":35,\"args\":[\"int\",\"int\"],\"argValues\":[\"@fun:是否打印调试信息\",1],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":51,\"nodeId\":\"A9CBBB5B5C49A8E90F3B137461796CD5\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:31\"],\"args\":[\"bool\"],\"next\":[{\"funIndex\":53,\"nodeId\":\"BA947A66AB82BFCBCBAB2B9DE90AAA07\",\"class\":\"__BUILTIN__\",\"name\":\"writeln\",\"index\":3,\"args\":[\"string\"],\"argValues\":[\"调用开火失败\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":52,\"nodeId\":\"8E6319ECC3502ACE77BCB8B70BAD3508\",\"class\":\"__BUILTIN__\",\"name\":\"writeln\",\"index\":3,\"args\":[\"string\"],\"argValues\":[\"调用开火成功\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"},\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"@variable\":{\"breakLoop&{\\\"fatherGroupId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"fatherSourceId\\\":\\\"user\\\",\\\"sourceId\\\":\\\"706F612A8384B89167AC019B326F77D9\\\",\\\"userId\\\":97}@funIndex_0\":{\"type\":\"bool\",\"value\":false}}},\"returnType\":\"none\",\"autoRelay\":false,\"funId\":\"706F612A8384B89167AC019B326F77D9\"}"
            ]
            json_data = "".join(json_strs)
        else:
            json_data = {
                "fun": "infoGlobalFun",
                "funcName": "朝目标开火",
                "taskId": config.task_id,
                "argValues": [self_platform, target_name],
                "isTask": False
            }
        return {
                "func_name": "fire_track",
                "args": [self_platform, target_name],
                "json_data": json_data
            }

    @staticmethod
    def fly_to_target(self_platform: str, target_platform: str, speed: float):
        """
        跟随目标机动
        self_platform : 自身平台名称
        target_platform : 目标平台名称
        speed : 速度（单位：米/秒）
        """
        if config.send_to_ws:
            json_strs = [
                "{\"fun\":\"yxCallFun\",\"data\":{\"funIndex\":0,\"nodeId\":\"2588A40432D98D7D69A7282F79178198\",\"class\":\"@function\",\"name\":\"朝目标飞\",\"returnType\":\"none\",\"args\":[\"WsfPlatform\",\"WsfPlatform\",\"double\"],\"argValues\":[",
                "\"", self_platform, "\",",
                "\"", target_platform, "\",",
                str(speed),
                "],\"argNames\":[\"@fun:执行对象\",\"@fun:目标平台\",\"@fun:速度\"],\"next\":[{\"funIndex\":7,\"nodeId\":\"89D89A55E6EFDFDF347DB638EB682B11\",\"class\":\"WsfPlatform\",\"id\":\"@fun:目标平台\",\"name\":\"Location\",\"index\":127,\"next\":[{\"funIndex\":8,\"nodeId\":\"B392D99B5821730977BDDC2B61B66A2A\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行对象\",\"name\":\"GoToPoint\",\"index\":174,\"args\":[\"WsfGeoPoint\"],\"argValues\":[\"@funIndex:7\"],\"next\":[{\"funIndex\":9,\"nodeId\":\"F918680884B9B0DF0A4F53C2244FF0C8\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行对象\",\"name\":\"GoToSpeed\",\"index\":190,\"args\":[\"double\",\"double\",\"bool\"],\"argValues\":[\"@fun:速度\",1000,true],\"next\":[{\"returnValue\":{\"name\":\"@funIndex:0\"},\"nodeId\":\"B5C4881700D89124BDF432BE0746D54D\",\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"2588A40432D98D7D69A7282F79178198\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"2588A40432D98D7D69A7282F79178198\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"2588A40432D98D7D69A7282F79178198\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"2588A40432D98D7D69A7282F79178198\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"2588A40432D98D7D69A7282F79178198\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"2588A40432D98D7D69A7282F79178198\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"2588A40432D98D7D69A7282F79178198\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"2588A40432D98D7D69A7282F79178198\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"@variable\":{}},\"returnType\":\"none\",\"autoRelay\":false,\"funId\":\"2588A40432D98D7D69A7282F79178198\"}"
            ]
            json_data = "".join(json_strs)
        else:
            json_data = {
                "fun": "infoGlobalFun",
                "funcName": "朝目标飞",
                "taskId": config.task_id,
                "argValues": [self_platform, target_platform, speed],
                "isTask": False
            }
        return {
                "func_name": "fly_to_target",
                "args": [self_platform, target_platform, speed],
                "json_data": json_data
            }

    @staticmethod
    def fly_to_point(self_platform: str, target_point: list, speed: float):
        """
        朝目的地机动
        self_platform : 自身平台名称
        target_point : 目的地[纬度（单位：度）,经度（单位：度）,高度（单位：米）]
        speed : 速度（单位：米/秒）
        """
        if config.send_to_ws:
            json_strs = [
                "{\"fun\":\"yxCallFun\",\"data\":{\"funIndex\":0,\"nodeId\":\"D3F7D12B54671687DB721D2295750C6D\",\"class\":\"@function\",\"name\":\"朝目标点飞\",\"returnType\":\"none\",\"args\":[\"WsfPlatform\",\"double\",\"double\",\"double\",\"double\"],\"argValues\":[",
                "\"", self_platform, "\",",
                str(target_point[0]), ",",
                str(target_point[1]), ",",
                str(target_point[2]), ",",
                str(speed),
                "],\"argNames\":[\"@fun:执行平台\",\"@fun:纬度\",\"@fun:经度\",\"@fun:海拔\",\"@fun:速度\"],\"next\":[{\"funIndex\":6,\"nodeId\":\"E5C891A292718F3555D14B805ABB6476\",\"class\":\"WsfGeoPoint\",\"name\":\"Construct\",\"index\":3,\"args\":[\"double\",\"double\",\"double\"],\"argValues\":[\"@fun:纬度\",\"@fun:经度\",\"@fun:海拔\"],\"next\":[{\"funIndex\":7,\"nodeId\":\"871D818E1CD89BF80FEC0F730D606F14\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"GoToPoint\",\"index\":174,\"args\":[\"WsfGeoPoint\"],\"argValues\":[\"@funIndex:6\"],\"next\":[{\"funIndex\":8,\"nodeId\":\"B0E7F9E5DB3D1B4A45C666B3EB3C94B0\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"GoToSpeed\",\"index\":190,\"args\":[\"double\",\"double\",\"bool\"],\"argValues\":[\"@fun:速度\",1000,true],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D3F7D12B54671687DB721D2295750C6D\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D3F7D12B54671687DB721D2295750C6D\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D3F7D12B54671687DB721D2295750C6D\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D3F7D12B54671687DB721D2295750C6D\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D3F7D12B54671687DB721D2295750C6D\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D3F7D12B54671687DB721D2295750C6D\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"@variable\":{}},\"returnType\":\"none\",\"autoRelay\":false,\"funId\":\"D3F7D12B54671687DB721D2295750C6D\"}"
            ]
            json_data = "".join(json_strs)
        else:
            json_data = {
                "fun": "infoGlobalFun",
                "funcName": "朝目标点飞",
                "taskId": config.task_id,
                "argValues": [self_platform, target_point[0], target_point[1], target_point[2], speed],
                "isTask": False
            }
        return {
                "func_name": "fly_to_point",
                "args": [self_platform, target_point[0], target_point[1], target_point[2], speed],
                "json_data": json_data
            }

    @staticmethod
    def route_patrol(self_platform: str, points: list, speed: float):
        """
        航线巡逻
        self_platform : 自身平台名称
        points : 航线点 list [[纬度, 经度, 海拔],[纬度, 经度, 海拔]]
        speed : 速度 (单位：米/秒)
        """
        waypoints = []
        points_str = ""
        try:
            for point in points:
                uuid_str = str(uuid.uuid4()).replace('-', '')
                waypoint = {
                    "altRef": 0,
                    "altitude": point[2],
                    "endOfPathOption": 2,
                    "id": uuid_str,
                    "label": "",
                    "latitude": point[0],
                    "linear_acceleration": 0,
                    "longitude": point[1],
                    "radial_acceleration": 0,
                    "speed": speed,
                    "switch": 0,
                    "turnDirection": 1,
                    "turn_g_limit": 0
                }
                waypoints.append(waypoint)
                t_str = str(waypoints)
                points_str = t_str.replace('"', '\\"').replace("'", '\\"')
        except ValueError:
            print('waypoint属性缺失')
            return None
        if config.send_to_ws:
            json_strs = [
                "{\"fun\":\"yxCallFun\",\"data\":{\"funIndex\":0,\"nodeId\":\"36D91BE3CC4DA401CE48919DEAC5BA1F\",\"class\":\"@function\",\"name\":\"航线巡逻\",\"returnType\":\"none\",\"args\":[\"WsfPlatform\",\"WsfRoute\"],\"argValues\":[",
                "\"", self_platform, "\",",
                "{\"points\":",
                points_str,
                "}],\"argNames\":[\"@fun:执行平台\",\"@fun:航线\"],\"next\":[{\"funIndex\":9,\"nodeId\":\"0E3AF7BA0A1A012F0FC6DFB5D6A0ECCF\",\"class\":\"WsfRoute\",\"name\":\"Create\",\"index\":59,\"args\":[\"string\"],\"argValues\":[\"WSF_ROUTE\"],\"next\":[{\"funIndex\":12,\"nodeId\":\"0583DBA9265B80DF978175A6D7199251\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"next\":[{\"funIndex\":13,\"nodeId\":\"A0798425619FC2455A048D2D099D5B20\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Speed\",\"index\":142,\"next\":[{\"funIndex\":10,\"nodeId\":\"13180A1A7A2429436819CC9F565726B5\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:9\",\"name\":\"Append\",\"index\":15,\"args\":[\"WsfGeoPoint\",\"double\"],\"argValues\":[\"@funIndex:12\",\"@funIndex:13\"],\"next\":[{\"funIndex\":11,\"nodeId\":\"7462116DFDCC0820F22A075A57386425\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:9\",\"name\":\"Append\",\"index\":14,\"args\":[\"WsfRoute\"],\"argValues\":[\"@fun:航线\"],\"next\":[{\"funIndex\":14,\"nodeId\":\"8F87DF6FE253325882A21E1886BFA393\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"FollowRoute\",\"index\":200,\"args\":[\"WsfRoute\"],\"argValues\":[\"@funIndex:9\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"36D91BE3CC4DA401CE48919DEAC5BA1F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"@variable\":{}},\"returnType\":\"none\",\"autoRelay\":false,\"funId\":\"36D91BE3CC4DA401CE48919DEAC5BA1F\"}"
            ]
            json_data = "".join(json_strs)
        else:
            json_data = {
                "fun": "infoGlobalFun",
                "funcName": "航线巡逻",
                "taskId": config.task_id,
                "argValues": [self_platform, {'points':waypoints}],
                "isTask": False
            }
        return {
                "func_name": "route_patrol",
                "args": [self_platform, {'points':waypoints}],
                "json_data": json_data
            }

    @staticmethod
    def area_patrol(self_platform: str, left_top_point: list, right_down_point: list, speed: float):
        """
        区域巡逻(矩形8字)
        self_platform : 自身平台名称
        left_top_point : 左上角点位置 [纬度，经度，海拔]
        right_down_point : 右下角点位置 [纬度，经度，海拔]
        speed : 速度（单位：米/秒）
        """
        if config.send_to_ws:
            max_lat, min_lat = left_top_point[0], right_down_point[0]
            if left_top_point[0] < right_down_point[0]:
                max_lat, min_lat = min_lat, max_lat
            max_lon, min_lon = right_down_point[1], left_top_point[1]
            if right_down_point[1] < left_top_point[1]:
                max_lon, min_lon = min_lon, max_lon
            json_strs = [
                "{\"fun\":\"yxCallFun\",\"data\":{\"funIndex\":0,\"nodeId\":\"D4C54DC09C9E7F2FA41841673C8BADD2\",\"class\":\"@function\",\"name\":\"区域巡逻\",\"returnType\":\"none\",\"returnValue\":null,\"args\":[\"WsfPlatform\",\"double\",\"double\",\"double\",\"double\",\"double\",\"double\",\"double\"],\"argValues\":[",
                "\"", self_platform, "\",",
                str(max_lat), ",",
                str(min_lon), ",",
                str(left_top_point[2]), ",",
                str(min_lat), ",",
                str(max_lon), ",",
                str(right_down_point[2]), ",",
                str(speed),
                "],\"argNames\":[\"@fun:执行平台\",\"@fun:lt纬度\",\"@fun:lt经度\",\"@fun:lt高度\",\"@fun:rd纬度\",\"@fun:rd经度\",\"@fun:rd海拔\",\"@fun:速度\"],\"next\":[{\"funIndex\":20,\"nodeId\":\"B5528D26A3F5183BA3E93451D3AF4772\",\"class\":\"WsfRoute\",\"name\":\"Create\",\"index\":59,\"args\":[\"string\"],\"argValues\":[\"WSF_ROUTE_TYPE\"],\"next\":[{\"funIndex\":23,\"nodeId\":\"84B801AF5AD3496C6092552B5BDF89FF\",\"class\":\"WsfGeoPoint\",\"name\":\"Construct\",\"index\":3,\"args\":[\"double\",\"double\",\"double\"],\"argValues\":[\"@fun:lt纬度\",\"@fun:lt经度\",\"@fun:lt高度\"],\"next\":[{\"funIndex\":21,\"nodeId\":\"5EAD7E13403170DF5CF8B56179BB56CC\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:20\",\"name\":\"Append\",\"index\":15,\"args\":[\"WsfGeoPoint\",\"double\"],\"argValues\":[\"@funIndex:23\",\"@fun:速度\"],\"next\":[{\"funIndex\":22,\"nodeId\":\"46EA2A0E85AA32749EFDBAAABFD423FD\",\"class\":\"WsfGeoPoint\",\"name\":\"Construct\",\"index\":3,\"args\":[\"double\",\"double\",\"double\"],\"argValues\":[\"@fun:lt纬度\",\"@fun:rd经度\",\"@fun:lt高度\"],\"next\":[{\"funIndex\":25,\"nodeId\":\"BC5AA11CE0459FC2FC43F7854E931D2D\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:20\",\"name\":\"Append\",\"index\":15,\"args\":[\"WsfGeoPoint\",\"double\"],\"argValues\":[\"@funIndex:22\",\"@fun:速度\"],\"next\":[{\"funIndex\":19,\"nodeId\":\"DC75341EB7090047E0D5FD99C0CFE64C\",\"class\":\"WsfGeoPoint\",\"name\":\"Construct\",\"index\":3,\"args\":[\"double\",\"double\",\"double\"],\"argValues\":[\"@fun:rd纬度\",\"@fun:lt经度\",\"@fun:rd海拔\"],\"next\":[{\"funIndex\":26,\"nodeId\":\"6086F8C4E940438374B4769969EF2824\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:20\",\"name\":\"Append\",\"index\":15,\"args\":[\"WsfGeoPoint\",\"double\"],\"argValues\":[\"@funIndex:19\",\"@fun:速度\"],\"next\":[{\"funIndex\":24,\"nodeId\":\"31911275E7088D5E4E86152288CF46BA\",\"class\":\"WsfGeoPoint\",\"name\":\"Construct\",\"index\":3,\"args\":[\"double\",\"double\",\"double\"],\"argValues\":[\"@fun:rd纬度\",\"@fun:rd经度\",\"@fun:rd海拔\"],\"next\":[{\"funIndex\":27,\"nodeId\":\"BF2A3C8DB2113CFB40AE592C6EA6A944\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:20\",\"name\":\"Append\",\"index\":15,\"args\":[\"WsfGeoPoint\",\"double\"],\"argValues\":[\"@funIndex:24\",\"@fun:速度\"],\"next\":[{\"funIndex\":29,\"nodeId\":\"EC5068A60ED624A8A14EA9899C1D0162\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:20\",\"name\":\"Append\",\"index\":15,\"args\":[\"WsfGeoPoint\",\"double\"],\"argValues\":[\"@funIndex:23\",\"@fun:速度\"],\"next\":[{\"funIndex\":28,\"nodeId\":\"6F587F7D8BD1E85CDCAA29C282F6A26A\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"FollowRoute\",\"index\":200,\"args\":[\"WsfRoute\"],\"argValues\":[\"@funIndex:20\"],\"next\":[{\"funIndex\":30,\"nodeId\":\"A39A9E8DD96A332CCCE48195A59E729B\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Mover\",\"index\":38,\"next\":[{\"funIndex\":31,\"nodeId\":\"8322E082F2A1A781A549805D78BFE540\",\"class\":\"WsfRouteMover\",\"name\":\"fromMover\",\"index\":70,\"args\":[\"WsfMover\"],\"argValues\":[\"@funIndex:30\"],\"next\":[{\"funIndex\":32,\"nodeId\":\"62C8DC1938FA0B63C33C426E6F9380EE\",\"class\":\"WsfRouteMover\",\"id\":\"@funIndex:31\",\"name\":\"SetLoopRoute\",\"index\":76,\"args\":[\"bool\"],\"argValues\":[true],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"fatherId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"nodeId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"@variable\":{\"max_lon&{\\\"fatherGroupId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"fatherSourceId\\\":\\\"user\\\",\\\"sourceId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"userId\\\":97}@funIndex_0\":{\"type\":\"double\",\"value\":0.01},\"min_lon&{\\\"fatherGroupId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"fatherSourceId\\\":\\\"user\\\",\\\"sourceId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"userId\\\":97}@funIndex_0\":{\"type\":\"double\",\"value\":0.01},\"max_lat&{\\\"fatherGroupId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"fatherSourceId\\\":\\\"user\\\",\\\"sourceId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"userId\\\":97}@funIndex_0\":{\"type\":\"double\",\"value\":0.01},\"min_lat&{\\\"fatherGroupId\\\":\\\"9BF7662FD33D960FC5BF332B703969FF\\\",\\\"fatherSourceId\\\":\\\"user\\\",\\\"sourceId\\\":\\\"D4C54DC09C9E7F2FA41841673C8BADD2\\\",\\\"userId\\\":97}@funIndex_0\":{\"type\":\"double\",\"value\":0.01}}},\"returnType\":\"none\",\"autoRelay\":false,\"funId\":\"D4C54DC09C9E7F2FA41841673C8BADD2\"}"
            ]
            json_data = "".join(json_strs)
        else:
            json_data = {
                "fun": "infoGlobalFun",
                "funcName": "区域巡逻",
                "taskId": config.task_id,
                "argValues": [self_platform, left_top_point[1], left_top_point[0], left_top_point[2], right_down_point[0], right_down_point[1], right_down_point[2], speed],
                "isTask": False
            }
        return {
                "func_name": "area_patrol",
                "args": [self_platform, left_top_point[1], left_top_point[0], left_top_point[2], right_down_point[0], right_down_point[1], right_down_point[2], speed],
                "json_data": json_data
            }

    def sim_control(self, option: str, sim_type = None):
        """
        控制推演
        option: play（播放）, edit（停止）, pause（暂停）, restart（重置）, step（继续下一帧）
        sim_type: 1.realTime:实时仿真（无倍速）;2.frameStepped:逐帧仿真(有倍速)
        """
        if self.s_ws is not None:
            data = {
                "fun": "simControl",
                "option": option,
            }
            if option == 'play':
                if sim_type is not None:
                    data['simType'] = sim_type
                    if sim_type == 'frameStepped':
                        data['timeStep'] = 1
            elif option == 'edit':
                data['rate'] = 1
            self.send_msg_ws(data)
        else:
            print('未连接到推演服务器')

    def sim_control_set_rate(self, rate):
        if rate in self.sim_data.rate_list:
            data = {
                "fun": "simControl",
                "rate": rate
            }
            self.sim_data.current_rate = rate
            self.send_msg_ws(data)
        else:
            print(f'rate应在{self.sim_data.rate_list}中取值')

    def set_scenario_ws(self, scenario_ws):
        """
        设置推演服务器websocket
        """
        self.s_ws = scenario_ws

    def step(self, frame, func): # frame为0时不暂停，大于0时按值暂停
        done = [False, False, False]
        if frame > 0:
            if self.sim_data.frame == 0 and self.wait_next:
                self.wait_next = False
                done = func()
                if done[0]:
                    self.sim_control('edit')
                    return done
                self.sim_data.frame = frame
                self.sim_control('step')
            else:
                self.wait_next = True
        else:
            done = func()
        time.sleep(0.02)
        return done

    def set_simulation_input(self, frame_time):
        """
        设置想定属性
        """
        if config.current_config == config.AUTO_ENGAGE_CONFIG:
            str_data = "{\"fun\":\"update\",\"data\":{\"yxBehaviorTree\":{\"objectEvent\":{\"yxSimpleComm\":{\"红无人机1&通信\":{\"@variable\":{}},\"红无人机2&通信\":{\"@variable\":{}},\"红无人机3&通信\":{\"@variable\":{}},\"红无人机4&通信\":{\"@variable\":{}},\"红有人机1&通信\":{\"@variable\":{}},\"蓝无人机1&通信\":{\"@variable\":{}},\"蓝无人机2&通信\":{\"@variable\":{}},\"蓝无人机3&通信\":{\"@variable\":{}},\"蓝无人机4&通信\":{\"@variable\":{}},\"蓝有人机1&通信\":{\"@variable\":{}}},\"WsfSensor\":{\"红无人机1&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":2,\"nodeId\":\"6850EA8B73960132902BFA1BBD68D8F4\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":4,\"nodeId\":\"29398565F30ADAF03B48731D2793E70B\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:2\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":3,\"nodeId\":\"825D22D126A636ECE2E564BF26F6A624\",\"class\":\"WsfComm\",\"id\":\"@funIndex:4\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":1,\"nodeId\":\"9F63C516990C1A825CF9D25AC02DC692\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:2\",\"track\"]}]}]}]},\"@variable\":{}},\"红无人机2&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":7,\"nodeId\":\"6850EA8B73960132902BFA1BBD68D8F4\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":9,\"nodeId\":\"29398565F30ADAF03B48731D2793E70B\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:7\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":8,\"nodeId\":\"825D22D126A636ECE2E564BF26F6A624\",\"class\":\"WsfComm\",\"id\":\"@funIndex:9\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":6,\"nodeId\":\"9F63C516990C1A825CF9D25AC02DC692\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:7\",\"track\"]}]}]}]},\"@variable\":{}},\"红无人机3&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":12,\"nodeId\":\"6850EA8B73960132902BFA1BBD68D8F4\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":14,\"nodeId\":\"29398565F30ADAF03B48731D2793E70B\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:12\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":13,\"nodeId\":\"825D22D126A636ECE2E564BF26F6A624\",\"class\":\"WsfComm\",\"id\":\"@funIndex:14\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":11,\"nodeId\":\"9F63C516990C1A825CF9D25AC02DC692\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:12\",\"track\"]}]}]}]},\"@variable\":{}},\"红无人机4&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":17,\"nodeId\":\"6850EA8B73960132902BFA1BBD68D8F4\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":19,\"nodeId\":\"29398565F30ADAF03B48731D2793E70B\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:17\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":18,\"nodeId\":\"825D22D126A636ECE2E564BF26F6A624\",\"class\":\"WsfComm\",\"id\":\"@funIndex:19\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":16,\"nodeId\":\"9F63C516990C1A825CF9D25AC02DC692\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:17\",\"track\"]}]}]}]},\"@variable\":{}},\"红有人机1&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":23,\"nodeId\":\"605A0773C298C15E5C13E2693213842C\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":25,\"nodeId\":\"B734D7E9A718E8593D4096E32FF1026C\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:23\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":24,\"nodeId\":\"17F3D8312F37D45A97EE8DDAEC30CA90\",\"class\":\"WsfComm\",\"id\":\"@funIndex:25\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":22,\"nodeId\":\"B652B3F8D0C20A4E470174B737CCC955\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:23\",\"track\"]}]}]}]},\"@variable\":{}},\"蓝无人机1&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":27,\"nodeId\":\"6850EA8B73960132902BFA1BBD68D8F4\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":29,\"nodeId\":\"29398565F30ADAF03B48731D2793E70B\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:27\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":28,\"nodeId\":\"825D22D126A636ECE2E564BF26F6A624\",\"class\":\"WsfComm\",\"id\":\"@funIndex:29\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":26,\"nodeId\":\"9F63C516990C1A825CF9D25AC02DC692\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:27\",\"track\"]}]}]}]},\"@variable\":{}},\"蓝无人机2&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":32,\"nodeId\":\"6850EA8B73960132902BFA1BBD68D8F4\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":34,\"nodeId\":\"29398565F30ADAF03B48731D2793E70B\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:32\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":33,\"nodeId\":\"825D22D126A636ECE2E564BF26F6A624\",\"class\":\"WsfComm\",\"id\":\"@funIndex:34\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":31,\"nodeId\":\"9F63C516990C1A825CF9D25AC02DC692\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:32\",\"track\"]}]}]}]},\"@variable\":{}},\"蓝无人机3&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":37,\"nodeId\":\"6850EA8B73960132902BFA1BBD68D8F4\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":39,\"nodeId\":\"29398565F30ADAF03B48731D2793E70B\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:37\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":38,\"nodeId\":\"825D22D126A636ECE2E564BF26F6A624\",\"class\":\"WsfComm\",\"id\":\"@funIndex:39\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":36,\"nodeId\":\"9F63C516990C1A825CF9D25AC02DC692\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:37\",\"track\"]}]}]}]},\"@variable\":{}},\"蓝无人机4&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":42,\"nodeId\":\"6850EA8B73960132902BFA1BBD68D8F4\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":44,\"nodeId\":\"29398565F30ADAF03B48731D2793E70B\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:42\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":43,\"nodeId\":\"825D22D126A636ECE2E564BF26F6A624\",\"class\":\"WsfComm\",\"id\":\"@funIndex:44\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":41,\"nodeId\":\"9F63C516990C1A825CF9D25AC02DC692\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:42\",\"track\"]}]}]}]},\"@variable\":{}},\"蓝有人机1&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":48,\"nodeId\":\"605A0773C298C15E5C13E2693213842C\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":50,\"nodeId\":\"B734D7E9A718E8593D4096E32FF1026C\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:48\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":49,\"nodeId\":\"17F3D8312F37D45A97EE8DDAEC30CA90\",\"class\":\"WsfComm\",\"id\":\"@funIndex:50\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":47,\"nodeId\":\"B652B3F8D0C20A4E470174B737CCC955\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:48\",\"track\"]}]}]}]},\"@variable\":{}}},\"WsfWeapon\":{\"红无人机1&导弹\":{\"@variable\":{}},\"红无人机2&导弹\":{\"@variable\":{}},\"红无人机3&导弹\":{\"@variable\":{}},\"红无人机4&导弹\":{\"@variable\":{}},\"红有人机1&导弹\":{\"@variable\":{}},\"蓝无人机1&导弹\":{\"@variable\":{}},\"蓝无人机2&导弹\":{\"@variable\":{}},\"蓝无人机3&导弹\":{\"@variable\":{}},\"蓝无人机4&导弹\":{\"@variable\":{}},\"蓝有人机1&导弹\":{\"@variable\":{}}},\"WsfMover\":{\"红无人机1&mover\":{\"@variable\":{}},\"红无人机2&mover\":{\"@variable\":{}},\"红无人机3&mover\":{\"@variable\":{}},\"红无人机4&mover\":{\"@variable\":{}},\"红有人机1&mover\":{\"@variable\":{}},\"蓝无人机1&mover\":{\"@variable\":{}},\"蓝无人机2&mover\":{\"@variable\":{}},\"蓝无人机3&mover\":{\"@variable\":{}},\"蓝无人机4&mover\":{\"@variable\":{}},\"蓝有人机1&mover\":{\"@variable\":{}}},\"WsfPlatform\":{\"红无人机1\":{\"@variable\":{}},\"红无人机2\":{\"@variable\":{}},\"红无人机3\":{\"@variable\":{}},\"红无人机4\":{\"@variable\":{}},\"红有人机1\":{\"@variable\":{}},\"蓝无人机1\":{\"@variable\":{}},\"蓝无人机2\":{\"@variable\":{}},\"蓝无人机3\":{\"@variable\":{}},\"蓝无人机4\":{\"@variable\":{}},\"蓝有人机1\":{\"@variable\":{}}},\"WsfSimulation\":{\"Tick\":{\"funIndex\":92,\"nodeId\":\"116EF54180905A869B942733370552B3\",\"class\":\"@sequence\",\"sequence\":[{\"funIndex\":94,\"nodeId\":\"EC65ED358DAA3DC07FCD01EE4CDD34A1\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":42,\"args\":[\"double\",\"double\"],\"argValues\":[\"simTime\",1],\"next\":[{\"funIndex\":93,\"nodeId\":\"B13F7011177FDE733E142EA41F08A75E\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:94\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":91,\"nodeId\":\"85676BE4CBC1AC9F212C6761FE930E1C\",\"class\":\"@branch\",\"argValues\":[\"@variable:doOnce&globle\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":95,\"nodeId\":\"6F587E49B9354DB2BD49B9E872A83FF9\",\"class\":\"@set\",\"argValues\":[\"@variable:doOnce&globle\",false],\"args\":[\"bool\",\"bool\"],\"next\":[{\"funIndex\":96,\"nodeId\":\"3307437ADE274ACA0520EAFE989B4F4E\",\"class\":\"WsfSimulation\",\"name\":\"PlatformCount\",\"index\":6,\"next\":[{\"funIndex\":97,\"nodeId\":\"152D4941998096D5D5AB6659A257F663\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":41,\"args\":[\"int\",\"int\"],\"argValues\":[\"@funIndex:96\",0],\"next\":[{\"funIndex\":98,\"nodeId\":\"51C804A0AE6C55B48B586A037BA5B99C\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:97\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":100,\"nodeId\":\"E837F138FC0A02A14963419B43344E01\",\"class\":\"yxBehaviorTools\",\"name\":\"-\",\"index\":9,\"args\":[\"int\",\"int\"],\"argValues\":[\"@funIndex:96\",1],\"next\":[{\"funIndex\":99,\"nodeId\":\"9E4029914CF7D3C8E5717870347AF7B6\",\"class\":\"@for\",\"argValues\":[0,\"@funIndex:100\"],\"args\":[\"int\",\"int\"],\"subNext\":{\"funIndex\":101,\"nodeId\":\"1154031E500EB6217281D57F24D23F72\",\"class\":\"WsfSimulation\",\"name\":\"PlatformEntry\",\"index\":7,\"args\":[\"int\"],\"argValues\":[\"@funIndex:99\"],\"next\":[{\"funIndex\":102,\"nodeId\":\"6A0E987A001B6ED1B62F0C4FAEF88823\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:101\",\"name\":\"SensorEntry\",\"index\":58,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":103,\"nodeId\":\"763A22009647C5A7BF15BB861D86205E\",\"class\":\"WsfSensor\",\"id\":\"@funIndex:102\",\"name\":\"Xmtr\",\"index\":154,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":104,\"nodeId\":\"C533E26F034BC30E691159016EFC8BD7\",\"class\":\"WsfEM_Xmtr\",\"id\":\"@funIndex:103\",\"name\":\"SetPower\",\"index\":30,\"args\":[\"double\"],\"argValues\":[1000000000000]}]}]}]}}]}]}]}]}]}]}]}]},{\"funIndex\":69,\"nodeId\":\"10729414220644FDF881B38076F9C037\",\"class\":\"Math\",\"name\":\"Fmod\",\"index\":50,\"args\":[\"double\",\"double\"],\"argValues\":[\"simTime\",\"@variable:delta_time&globle\"],\"next\":[{\"funIndex\":75,\"nodeId\":\"4C385178337F5B2DF5B81BA254C43BB9\",\"class\":\"yxBehaviorTools\",\"name\":\"<\",\"index\":46,\"args\":[\"double\",\"double\"],\"argValues\":[\"@funIndex:69\",0.2],\"next\":[{\"funIndex\":70,\"nodeId\":\"2955181D47A0E08F4BC335879BC2E86D\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:75\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":72,\"nodeId\":\"1B90F3BAA7C17DCB0AA8EEF5D574421B\",\"class\":\"WsfSimulation\",\"name\":\"PlatformCount\",\"index\":6,\"next\":[{\"funIndex\":88,\"nodeId\":\"4A50E22236A5B4D94322D1FC6E194358\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":41,\"args\":[\"int\",\"int\"],\"argValues\":[\"@funIndex:72\",0],\"next\":[{\"funIndex\":89,\"nodeId\":\"FF838047BA3831DA1A0C5D8180A4FE9B\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:88\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":73,\"nodeId\":\"2109A915236F26FB4864EB0DB725B07C\",\"class\":\"yxBehaviorTools\",\"name\":\"-\",\"index\":9,\"args\":[\"int\",\"int\"],\"argValues\":[\"@funIndex:72\",1],\"next\":[{\"funIndex\":71,\"nodeId\":\"C6F8D8809CE57A80FE4C6CC4723D22CB\",\"class\":\"@for\",\"argValues\":[0,\"@funIndex:73\"],\"args\":[\"int\",\"int\"],\"subNext\":{\"funIndex\":74,\"nodeId\":\"B78928344464AC9870E431EB34D5776B\",\"class\":\"WsfSimulation\",\"name\":\"PlatformEntry\",\"index\":7,\"args\":[\"int\"],\"argValues\":[\"@funIndex:71\"],\"next\":[{\"funIndex\":76,\"nodeId\":\"F30F28641694BCDD05AEF755FC1BC998\",\"class\":\"@sequence\",\"sequence\":[{\"funIndex\":77,\"nodeId\":\"7887578F5D2295C07554086AE64FDB18\",\"class\":\"@function\",\"name\":\"超出边界后销毁\",\"next\":[{\"funIndex\":107,\"nodeId\":\"C3C81D1455AF3F716F01B0642C56E3C5\",\"class\":\"@sequence\",\"sequence\":[{\"funIndex\":124,\"nodeId\":\"D74A8CBD1DB16D9D65773536D0FA94CF\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Type\",\"index\":4,\"next\":[{\"funIndex\":125,\"nodeId\":\"A4EF87A6173F2B7E8F124CB11CDB76F1\",\"class\":\"yxBehaviorTools\",\"name\":\"==\",\"index\":37,\"args\":[\"string\",\"string\"],\"argValues\":[\"@funIndex:124\",\"无人机\"],\"next\":[{\"funIndex\":126,\"nodeId\":\"C5A7D0830E2C908E741C94AF3F883732\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:125\"],\"args\":[\"bool\"],\"next\":[{\"funIndex\":128,\"nodeId\":\"F883EDDB67274AE349052F714B6BE895\",\"class\":\"@branch\",\"argValues\":[{\"funIndex\":127,\"nodeId\":\"6BCC6CB030B74A909787D8F77D74D230\",\"class\":\"yxBehaviorTools\",\"name\":\"==\",\"index\":37,\"args\":[\"string\",\"string\"],\"argValues\":[\"@funIndex:124\",\"有人机\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":142,\"nodeId\":\"621F9A34F5FFA9001A6449D087E24774\",\"class\":\"@branch\",\"argValues\":[{\"funIndex\":117,\"nodeId\":\"E67A490E70B1081AB40FAADEFFE8AC9A\",\"class\":\"yxBehaviorTools\",\"name\":\"||\",\"index\":33,\"args\":[\"bool\",\"bool\"],\"argValues\":[{\"funIndex\":113,\"nodeId\":\"2D5729688E51161D17E3F8F67C544B4D\",\"class\":\"yxBehaviorTools\",\"name\":\"||\",\"index\":33,\"args\":[\"bool\",\"bool\"],\"argValues\":[{\"funIndex\":112,\"nodeId\":\"1D29072922AB03A08BCAB9C50104C4CB\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":42,\"args\":[\"double\",\"double\"],\"argValues\":[{\"funIndex\":109,\"nodeId\":\"CA4DB7CCE88C4BDA220DF323ACFD7E87\",\"class\":\"WsfGeoPoint\",\"id\":{\"funIndex\":108,\"nodeId\":\"B867429B6512C88358CEAEB08692D2DD\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Longitude\",\"index\":9,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@fun:max_lon\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":111,\"nodeId\":\"F943956B5E3C3B7135C14DCAAC390E30\",\"class\":\"yxBehaviorTools\",\"name\":\"<\",\"index\":46,\"args\":[\"double\",\"double\"],\"argValues\":[{\"funIndex\":109,\"nodeId\":\"CA4DB7CCE88C4BDA220DF323ACFD7E87\",\"class\":\"WsfGeoPoint\",\"id\":{\"funIndex\":108,\"nodeId\":\"B867429B6512C88358CEAEB08692D2DD\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Longitude\",\"index\":9,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@fun:min_lon\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":114,\"nodeId\":\"FF128714F977CFCACA20070D7A450EEB\",\"class\":\"yxBehaviorTools\",\"name\":\"||\",\"index\":33,\"args\":[\"bool\",\"bool\"],\"argValues\":[{\"funIndex\":116,\"nodeId\":\"7A15879881FC88A82C21164FBCC2F755\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":42,\"args\":[\"double\",\"double\"],\"argValues\":[{\"funIndex\":110,\"nodeId\":\"88BDD9EB5DA1C900253CA73D03AE6333\",\"class\":\"WsfGeoPoint\",\"id\":{\"funIndex\":108,\"nodeId\":\"B867429B6512C88358CEAEB08692D2DD\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Latitude\",\"index\":8,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@fun:max_lat\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":115,\"nodeId\":\"4CCE93C256EA09158771035467384520\",\"class\":\"yxBehaviorTools\",\"name\":\"<\",\"index\":46,\"args\":[\"double\",\"double\"],\"argValues\":[{\"funIndex\":110,\"nodeId\":\"88BDD9EB5DA1C900253CA73D03AE6333\",\"class\":\"WsfGeoPoint\",\"id\":{\"funIndex\":108,\"nodeId\":\"B867429B6512C88358CEAEB08692D2DD\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Latitude\",\"index\":8,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@fun:min_lat\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"bool\"],\"next\":[{\"funIndex\":143,\"nodeId\":\"9C2D4F5A9D21DEAAE735B6061E04F14E\",\"class\":\"Map<string,double>\",\"id\":\"@fun:@addr:time_map\",\"name\":\"Exists\",\"index\":8,\"args\":[\"string\"],\"argValues\":[{\"funIndex\":123,\"nodeId\":\"D231A790564A3BCE08279B4E967D7D52\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Name\",\"index\":3,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"next\":[{\"funIndex\":144,\"nodeId\":\"EF93F54F57A229B9C3F0DA7B9D7B0859\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:143\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":145,\"nodeId\":\"B0448E59C99D2B63E18BBF7A27153636\",\"class\":\"Map<string,double>\",\"id\":\"@fun:@addr:time_map\",\"name\":\"Remove\",\"index\":6,\"args\":[\"string\"],\"argValues\":[{\"funIndex\":123,\"nodeId\":\"D231A790564A3BCE08279B4E967D7D52\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Name\",\"index\":3,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":130,\"nodeId\":\"AEE283608E70CC659C484B4E821B3F62\",\"class\":\"Map<string,double>\",\"id\":\"@fun:@addr:time_map\",\"name\":\"Exists\",\"index\":8,\"args\":[\"string\"],\"argValues\":[{\"funIndex\":123,\"nodeId\":\"D231A790564A3BCE08279B4E967D7D52\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Name\",\"index\":3,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"next\":[{\"funIndex\":131,\"nodeId\":\"4AE3FAC977A81D36BD009AFA842F05AC\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:130\"],\"args\":[\"bool\"],\"next\":[{\"funIndex\":132,\"nodeId\":\"EDEA63F846A13171D8372B5581AC5DB1\",\"class\":\"WsfSimulation\",\"name\":\"GetSimTime\",\"index\":49,\"next\":[{\"funIndex\":129,\"nodeId\":\"44B1BD2FF1B7E4D94FF3948565B611A3\",\"class\":\"Map<string,double>\",\"id\":\"@fun:@addr:time_map\",\"name\":\"__Insert\",\"index\":14,\"args\":[\"string\",\"double\"],\"argValues\":[{\"funIndex\":123,\"nodeId\":\"D231A790564A3BCE08279B4E967D7D52\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Name\",\"index\":3,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@funIndex:132\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":133,\"nodeId\":\"773D65A35EB425616C13D971A51C08E7\",\"class\":\"Map<string,double>\",\"id\":\"@fun:@addr:time_map\",\"name\":\"Get\",\"index\":15,\"args\":[\"string\"],\"argValues\":[{\"funIndex\":123,\"nodeId\":\"D231A790564A3BCE08279B4E967D7D52\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Name\",\"index\":3,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"next\":[{\"funIndex\":135,\"nodeId\":\"DDCCDD43BB5EF75F1FF96B4CD88D658A\",\"class\":\"WsfSimulation\",\"name\":\"GetSimTime\",\"index\":49,\"next\":[{\"funIndex\":136,\"nodeId\":\"5C6F0122E5A508A1BFFE4F08B3B2C6A4\",\"class\":\"yxBehaviorTools\",\"name\":\"<\",\"index\":46,\"args\":[\"double\",\"double\"],\"argValues\":[{\"funIndex\":134,\"nodeId\":\"71F658E548C2C16B1F30388068D9FB62\",\"class\":\"yxBehaviorTools\",\"name\":\"+\",\"index\":4,\"args\":[\"double\",\"double\"],\"argValues\":[\"@funIndex:133\",30],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@funIndex:135\"],\"next\":[{\"funIndex\":137,\"nodeId\":\"F7D3F2E3B05786029F33F334469F6D8E\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:136\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":139,\"nodeId\":\"E2DD6CB6D6FB17CB546E260AD8A84B3E\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Detonate\",\"index\":333,\"args\":[\"string\"],\"argValues\":[{\"funIndex\":123,\"nodeId\":\"D231A790564A3BCE08279B4E967D7D52\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Name\",\"index\":3,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"next\":[{\"funIndex\":140,\"nodeId\":\"4D3961F57D7A40BBB33DEB5C2EEF6E5C\",\"class\":\"yxBehaviorTools\",\"name\":\"isNull\",\"index\":50,\"args\":[\"void\"],\"argValues\":[\"@fun:执行平台\"],\"next\":[{\"funIndex\":141,\"nodeId\":\"40BCDC0B4E20307F79ED360F906531A0\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:140\"],\"args\":[\"bool\"],\"next\":[{\"funIndex\":138,\"nodeId\":\"C52A80F50D59D240967F428A7EA82B84\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"DeletePlatform\",\"index\":287,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":118,\"nodeId\":\"BCEB06D963D087C65D47CBABBABE78CA\",\"class\":\"@branch\",\"argValues\":[{\"funIndex\":117,\"nodeId\":\"E67A490E70B1081AB40FAADEFFE8AC9A\",\"class\":\"yxBehaviorTools\",\"name\":\"||\",\"index\":33,\"args\":[\"bool\",\"bool\"],\"argValues\":[{\"funIndex\":113,\"nodeId\":\"2D5729688E51161D17E3F8F67C544B4D\",\"class\":\"yxBehaviorTools\",\"name\":\"||\",\"index\":33,\"args\":[\"bool\",\"bool\"],\"argValues\":[{\"funIndex\":112,\"nodeId\":\"1D29072922AB03A08BCAB9C50104C4CB\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":42,\"args\":[\"double\",\"double\"],\"argValues\":[{\"funIndex\":109,\"nodeId\":\"CA4DB7CCE88C4BDA220DF323ACFD7E87\",\"class\":\"WsfGeoPoint\",\"id\":{\"funIndex\":108,\"nodeId\":\"B867429B6512C88358CEAEB08692D2DD\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Longitude\",\"index\":9,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@fun:max_lon\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":111,\"nodeId\":\"F943956B5E3C3B7135C14DCAAC390E30\",\"class\":\"yxBehaviorTools\",\"name\":\"<\",\"index\":46,\"args\":[\"double\",\"double\"],\"argValues\":[{\"funIndex\":109,\"nodeId\":\"CA4DB7CCE88C4BDA220DF323ACFD7E87\",\"class\":\"WsfGeoPoint\",\"id\":{\"funIndex\":108,\"nodeId\":\"B867429B6512C88358CEAEB08692D2DD\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Longitude\",\"index\":9,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@fun:min_lon\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":114,\"nodeId\":\"FF128714F977CFCACA20070D7A450EEB\",\"class\":\"yxBehaviorTools\",\"name\":\"||\",\"index\":33,\"args\":[\"bool\",\"bool\"],\"argValues\":[{\"funIndex\":116,\"nodeId\":\"7A15879881FC88A82C21164FBCC2F755\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":42,\"args\":[\"double\",\"double\"],\"argValues\":[{\"funIndex\":110,\"nodeId\":\"88BDD9EB5DA1C900253CA73D03AE6333\",\"class\":\"WsfGeoPoint\",\"id\":{\"funIndex\":108,\"nodeId\":\"B867429B6512C88358CEAEB08692D2DD\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Latitude\",\"index\":8,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@fun:max_lat\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":115,\"nodeId\":\"4CCE93C256EA09158771035467384520\",\"class\":\"yxBehaviorTools\",\"name\":\"<\",\"index\":46,\"args\":[\"double\",\"double\"],\"argValues\":[{\"funIndex\":110,\"nodeId\":\"88BDD9EB5DA1C900253CA73D03AE6333\",\"class\":\"WsfGeoPoint\",\"id\":{\"funIndex\":108,\"nodeId\":\"B867429B6512C88358CEAEB08692D2DD\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Latitude\",\"index\":8,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},\"@fun:min_lat\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":120,\"nodeId\":\"49D75D0B624B6580E230BAA531F932BD\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Detonate\",\"index\":333,\"args\":[\"string\"],\"argValues\":[{\"funIndex\":123,\"nodeId\":\"D231A790564A3BCE08279B4E967D7D52\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Name\",\"index\":3,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"next\":[{\"funIndex\":121,\"nodeId\":\"9B5A40CBBEC8B7CF5B7660C15FBB4A4D\",\"class\":\"yxBehaviorTools\",\"name\":\"isNull\",\"index\":50,\"args\":[\"void\"],\"argValues\":[\"@fun:执行平台\"],\"next\":[{\"funIndex\":122,\"nodeId\":\"58BFB416961E1B28EE9BD6B58E5738E2\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:121\"],\"args\":[\"bool\"],\"next\":[{\"funIndex\":119,\"nodeId\":\"27B7C51DD005D3E26BB9F58FCA0E7CC5\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"DeletePlatform\",\"index\":287,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"returnValue\":{\"name\":\"@funIndex:77\"},\"nodeId\":\"108CA372C82F18A9D7BEFFAC55F2A86F\",\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"4BCD446E3F79A66D980D82DC5ABA5846\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"7887578F5D2295C07554086AE64FDB18\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"WsfPlatform\",\"double\",\"double\",\"double\",\"double\",\"Map<string,double>\"],\"argValues\":[\"@funIndex:74\",\"@variable:max_lon&globle\",\"@variable:min_lon&globle\",\"@variable:max_lat&globle\",\"@variable:min_lat&globle\",\"@variable:time_map&globle\"],\"argNames\":[\"@fun:执行平台\",\"@fun:max_lon\",\"@fun:min_lon\",\"@fun:max_lat\",\"@fun:min_lat\",\"@fun:@addr:time_map\"],\"@variable\":{}},{\"funIndex\":78,\"nodeId\":\"9DDD3214E73BB35F12871FA6F80CAD5F\",\"class\":\"@function\",\"name\":\"路径结束时来回移动\",\"next\":[{\"funIndex\":170,\"nodeId\":\"47231FB43D66412C9779416790D006B2\",\"class\":\"@sequence\",\"sequence\":[{\"funIndex\":148,\"nodeId\":\"68C975B7E8B6D5179F41AFA1415F56E0\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Mover\",\"index\":38,\"next\":[{\"funIndex\":149,\"nodeId\":\"85FD6B0D0AB07A2CB467BF5CC1DEAF5D\",\"class\":\"WsfMover\",\"id\":\"@funIndex:148\",\"name\":\"Type\",\"index\":4,\"next\":[{\"funIndex\":150,\"nodeId\":\"F7E54759F2217803DE4A61A3B6FECEC6\",\"class\":\"yxBehaviorTools\",\"name\":\"==\",\"index\":37,\"args\":[\"string\",\"string\"],\"argValues\":[\"@funIndex:149\",\"WSF_AIR_MOVER\"],\"next\":[{\"funIndex\":151,\"nodeId\":\"516893C3B04E3449D818FA9C241C01EC\",\"class\":\"@branch\",\"argValues\":[\"@funIndex:150\"],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":158,\"nodeId\":\"08D62360C94089DDB888E97D47896862\",\"class\":\"@branch\",\"argValues\":[{\"funIndex\":157,\"nodeId\":\"C8C6BA981E4DD33C9F3D83B9A94B6871\",\"class\":\"yxBehaviorTools\",\"name\":\">=\",\"index\":43,\"args\":[\"int\",\"int\"],\"argValues\":[{\"funIndex\":155,\"nodeId\":\"6AB2AB66C564D1AB97865486823564D6\",\"class\":\"WsfRoute\",\"id\":{\"funIndex\":154,\"nodeId\":\"5CAECBD25AD435C95B43344B75487ECA\",\"class\":\"WsfRouteMover\",\"id\":{\"funIndex\":152,\"nodeId\":\"C7C510A1D7F1CD6E7768CFEBD5336704\",\"class\":\"WsfRouteMover\",\"name\":\"fromMover\",\"index\":70,\"args\":[\"WsfMover\"],\"argValues\":[\"@funIndex:148\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Route\",\"index\":50,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Size\",\"index\":30,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},2],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":156,\"nodeId\":\"550CEC38DFD359A98B1267D2BF2687CB\",\"class\":\"@branch\",\"argValues\":[{\"funIndex\":159,\"nodeId\":\"A7DDA2645A391CD13EE4E65F9143990C\",\"class\":\"yxBehaviorTools\",\"name\":\">=\",\"index\":43,\"args\":[\"int\",\"int\"],\"argValues\":[{\"funIndex\":153,\"nodeId\":\"7AFFB9CC975F7CD0AF0400208673B559\",\"class\":\"WsfRouteMover\",\"id\":{\"funIndex\":152,\"nodeId\":\"C7C510A1D7F1CD6E7768CFEBD5336704\",\"class\":\"WsfRouteMover\",\"name\":\"fromMover\",\"index\":70,\"args\":[\"WsfMover\"],\"argValues\":[\"@funIndex:148\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"RoutePointIndex\",\"index\":71,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":155,\"nodeId\":\"6AB2AB66C564D1AB97865486823564D6\",\"class\":\"WsfRoute\",\"id\":{\"funIndex\":154,\"nodeId\":\"5CAECBD25AD435C95B43344B75487ECA\",\"class\":\"WsfRouteMover\",\"id\":{\"funIndex\":152,\"nodeId\":\"C7C510A1D7F1CD6E7768CFEBD5336704\",\"class\":\"WsfRouteMover\",\"name\":\"fromMover\",\"index\":70,\"args\":[\"WsfMover\"],\"argValues\":[\"@funIndex:148\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Route\",\"index\":50,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Size\",\"index\":30,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"bool\"],\"next\":[{},{\"funIndex\":162,\"nodeId\":\"154D5521D698664C19225DD242C91598\",\"class\":\"WsfRoute\",\"name\":\"Create\",\"index\":59,\"args\":[\"string\"],\"argValues\":[\"WSF_ROUTE\"],\"next\":[{\"funIndex\":163,\"nodeId\":\"9997EF5F7E3B4F6C7614BB7D651E0002\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:162\",\"name\":\"Append\",\"index\":15,\"args\":[\"WsfGeoPoint\",\"double\"],\"argValues\":[{\"funIndex\":169,\"nodeId\":\"0DA9A0B1716D4EBC475CBB3844C558B2\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},20],\"next\":[{\"funIndex\":166,\"nodeId\":\"72B0FA75C7D0ACB8B37A1CD513B642D4\",\"class\":\"WsfGeoPoint\",\"id\":{\"funIndex\":165,\"nodeId\":\"C1CC6F5221E7E18E15EF32321E162DEA\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"Offset\",\"index\":34,\"args\":[\"double\",\"double\",\"double\",\"double\"],\"argValues\":[{\"funIndex\":167,\"nodeId\":\"E1E9A9E12EA60A1ABE9BEDAE90BE6025\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Heading\",\"index\":145,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},5000,0,0],\"next\":[{\"funIndex\":164,\"nodeId\":\"CF9F10A2C3DC382A3E19D2780C9B088C\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:162\",\"name\":\"Append\",\"index\":15,\"args\":[\"WsfGeoPoint\",\"double\"],\"argValues\":[{\"funIndex\":165,\"nodeId\":\"C1CC6F5221E7E18E15EF32321E162DEA\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},20],\"next\":[{\"funIndex\":168,\"nodeId\":\"37FB3AEA68DFBF0F37A1A57561F75E1B\",\"class\":\"WsfRoute\",\"id\":\"@funIndex:162\",\"name\":\"Append\",\"index\":15,\"args\":[\"WsfGeoPoint\",\"double\"],\"argValues\":[{\"funIndex\":169,\"nodeId\":\"0DA9A0B1716D4EBC475CBB3844C558B2\",\"class\":\"WsfPlatform\",\"id\":\"@fun:执行平台\",\"name\":\"Location\",\"index\":127,\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},20],\"next\":[{\"funIndex\":161,\"nodeId\":\"6217960F57A281A9CEAFE04561FA32E7\",\"class\":\"WsfSimulation\",\"name\":\"GetSimTime\",\"index\":49,\"next\":[{\"funIndex\":160,\"nodeId\":\"CDB55AEFA580C0FD03DACD0E8880AA74\",\"class\":\"WsfRouteMover\",\"id\":{\"funIndex\":152,\"nodeId\":\"C7C510A1D7F1CD6E7768CFEBD5336704\",\"class\":\"WsfRouteMover\",\"name\":\"fromMover\",\"index\":70,\"args\":[\"WsfMover\"],\"argValues\":[\"@funIndex:148\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},\"name\":\"SetRoute\",\"index\":73,\"args\":[\"double\",\"WsfRoute\"],\"argValues\":[\"@funIndex:161\",\"@funIndex:162\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"returnValue\":{\"name\":\"@funIndex:78\"},\"nodeId\":\"191419231BF41C6290A0A19590AF98AF\",\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"B545EB53D02CDE54605A4606FB7AE311\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"9DDD3214E73BB35F12871FA6F80CAD5F\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"WsfPlatform\"],\"argValues\":[\"@funIndex:74\"],\"argNames\":[\"@fun:执行平台\"],\"@variable\":{}}]}]}}]}]}]}]}]}]}]}]},\"SimulationStarting\":{\"funIndex\":64,\"nodeId\":\"00963746FBF4AE5E6CDD169C458AEBDD\",\"class\":\"@function\",\"name\":\"设置边界值\",\"next\":[{\"funIndex\":177,\"nodeId\":\"9AA23865525A03B44154B486A565D548\",\"class\":\"@sequence\",\"sequence\":[{\"funIndex\":174,\"nodeId\":\"537084A4EBCD2746FB8B2AA18C807A94\",\"class\":\"@branch\",\"argValues\":[{\"funIndex\":173,\"nodeId\":\"2629CD4A0C384003DE156C3F5B9F0DE0\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":42,\"args\":[\"double\",\"double\"],\"argValues\":[\"@fun:lon1\",\"@fun:lon2\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"bool\"],\"next\":[{\"funIndex\":181,\"nodeId\":\"0901100B1E3F714E917238BD6780890F\",\"class\":\"@set\",\"argValues\":[\"@fun:@addr:min_lon\",\"@fun:lon1\"],\"args\":[\"double\",\"double\"],\"next\":[{\"funIndex\":180,\"nodeId\":\"641275209433AE7F5ABB5F736D7BA131\",\"class\":\"@set\",\"argValues\":[\"@fun:@addr:max_lon\",\"@fun:lon2\"],\"args\":[\"double\",\"double\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":178,\"nodeId\":\"829650B759CC686DA98AF5F8623D955A\",\"class\":\"@set\",\"argValues\":[\"@fun:@addr:max_lon\",\"@fun:lon1\"],\"args\":[\"double\",\"double\"],\"next\":[{\"funIndex\":179,\"nodeId\":\"73E2536665C8994B0A3127AB1510DDFE\",\"class\":\"@set\",\"argValues\":[\"@fun:@addr:min_lon\",\"@fun:lon2\"],\"args\":[\"double\",\"double\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":175,\"nodeId\":\"942BEE859BC5E2E3DB659EBDE5EEB3AF\",\"class\":\"@branch\",\"argValues\":[{\"funIndex\":176,\"nodeId\":\"C1E91DC14461E5EDCC4F4AABCD9CBD21\",\"class\":\"yxBehaviorTools\",\"name\":\">\",\"index\":42,\"args\":[\"double\",\"double\"],\"argValues\":[\"@fun:lat1\",\"@fun:lat2\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"bool\"],\"next\":[{\"funIndex\":184,\"nodeId\":\"622727F104FEE855C057E109E63E4A3A\",\"class\":\"@set\",\"argValues\":[\"@fun:@addr:min_lat\",\"@fun:lat1\"],\"args\":[\"double\",\"double\"],\"next\":[{\"funIndex\":185,\"nodeId\":\"C787CEC905BCD060440EC4C128DC0DE8\",\"class\":\"@set\",\"argValues\":[\"@fun:@addr:max_lat\",\"@fun:lat2\"],\"args\":[\"double\",\"double\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"funIndex\":182,\"nodeId\":\"B24E35366DCB5516961037A8FF871D46\",\"class\":\"@set\",\"argValues\":[\"@fun:@addr:max_lat\",\"@fun:lat1\"],\"args\":[\"double\",\"double\"],\"next\":[{\"funIndex\":183,\"nodeId\":\"B3E8F815B438F25F96873BEA83C0EC2B\",\"class\":\"@set\",\"argValues\":[\"@fun:@addr:min_lat\",\"@fun:lat2\"],\"args\":[\"double\",\"double\"],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"},{\"returnValue\":{\"name\":\"@funIndex:64\"},\"nodeId\":\"32F0666B55EEDB205B36C1834AC6197E\",\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"checkId\":\"{\\\"sourceId\\\":\\\"user\\\",\\\"checkFunId\\\":\\\"9B036A0FDCECCDCA4577640950E45878\\\",\\\"fatherId\\\":\\\"DD2790113E922478F9D1050B174A18DA\\\",\\\"nodeId\\\":\\\"00963746FBF4AE5E6CDD169C458AEBDD\\\",\\\"type\\\":\\\"fun\\\"}\"}],\"args\":[\"double\",\"double\",\"double\",\"double\",\"double\",\"double\",\"double\",\"double\"],\"argValues\":[144.70215340342395,146.8796158023102,\"@variable:max_lon&globle\",\"@variable:min_lon&globle\",34.332266265855345,32.52122252788531,\"@variable:max_lat&globle\",\"@variable:min_lat&globle\"],\"argNames\":[\"@fun:lon1\",\"@fun:lon2\",\"@fun:@addr:max_lon\",\"@fun:@addr:min_lon\",\"@fun:lat1\",\"@fun:lat2\",\"@fun:@addr:max_lat\",\"@fun:@addr:min_lat\"],\"@variable\":{}}}},\"classEvent\":{\"WsfSensor\":{\"无人机&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":52,\"nodeId\":\"6850EA8B73960132902BFA1BBD68D8F4\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":54,\"nodeId\":\"29398565F30ADAF03B48731D2793E70B\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:52\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":53,\"nodeId\":\"825D22D126A636ECE2E564BF26F6A624\",\"class\":\"WsfComm\",\"id\":\"@funIndex:54\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":51,\"nodeId\":\"9F63C516990C1A825CF9D25AC02DC692\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:52\",\"track\"]}]}]}]},\"@variable\":{}},\"有人机&雷达\":{\"SensorTrackInitiated\":{\"funIndex\":58,\"nodeId\":\"605A0773C298C15E5C13E2693213842C\",\"class\":\"WsfSensor\",\"id\":\"@this\",\"name\":\"Platform\",\"index\":8,\"next\":[{\"funIndex\":60,\"nodeId\":\"B734D7E9A718E8593D4096E32FF1026C\",\"class\":\"WsfPlatform\",\"id\":\"@funIndex:58\",\"name\":\"CommEntry\",\"index\":41,\"args\":[\"int\"],\"argValues\":[0],\"next\":[{\"funIndex\":59,\"nodeId\":\"17F3D8312F37D45A97EE8DDAEC30CA90\",\"class\":\"WsfComm\",\"id\":\"@funIndex:60\",\"name\":\"SendMessage\",\"index\":20,\"args\":[\"WsfMessage\"],\"argValues\":[{\"funIndex\":57,\"nodeId\":\"B652B3F8D0C20A4E470174B737CCC955\",\"class\":\"WsfTrackMessage\",\"name\":\"Construct\",\"index\":31,\"args\":[\"WsfPlatform\",\"WsfTrack\"],\"argValues\":[\"@funIndex:58\",\"track\"]}]}]}]},\"@variable\":{}}}},\"timeEvent\":{},\"@variable\":{\"delta_time&globle\":{\"type\":\"double\",\"value\":0.8},\"max_lon&globle\":{\"type\":\"double\",\"value\":0.01},\"min_lon&globle\":{\"type\":\"double\",\"value\":0.01},\"max_lat&globle\":{\"type\":\"double\",\"value\":0.01},\"min_lat&globle\":{\"type\":\"double\",\"value\":0.01},\"time_map&globle\":{\"type\":\"Map<string,double>\"},\"doOnce&globle\":{\"type\":\"bool\",\"value\":true}}},\"simulationInput\":{\"end_time\":900,\"use_constant_required_pd\":true,\"step_num\":1}},\"isBreak\":true}"
            self.send_str_ws(str_data)

        data = {
            "fun": "debug",
            "debug": False
        }
        self.send_msg_ws(data)

        if frame_time < 0:
            frame_time = 1
        data = {
            "fun": "update",
            "data": {
                "simulationInput": {
                    "frame_time": frame_time,
                    "step_num": config.frame_num
                }
            }
        }
        self.send_msg_ws(data)
